package vulnerability

import "github.com/ctrsploit/sploit-spec/pkg/prerequisite"

type ExistsStruct struct {
	VulnerabilityExists bool
	prerequisite.BasePrerequisite
}

func (p *ExistsStruct) Check() (err error) {
	err = p.BasePrerequisite.Check()
	if err != nil {
		return
	}
	p.Satisfied = p.VulnerabilityExists
	return
}

func Exists(vulnerabilityExists bool) *ExistsStruct {
	return &ExistsStruct{
		VulnerabilityExists: vulnerabilityExists,
		BasePrerequisite: prerequisite.BasePrerequisite{
			Name:      "Vulnerability Exists",
			Info:      "",
			Satisfied: false,
		},
	}
}
